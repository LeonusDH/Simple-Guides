# **SSH** - Авторизация по ключу

> Расчёт на то, что вы используете своего пользователя а не `root`!

> Почему? Потому что **НЕ** надо разрешать подключение к `root` по **SSH**!

### Требования:

- Прямые руки
- Умение гуглить

## Создание **SSH** ключей

> Я генерирую их прямо на сервере, но в целом, это не принципиально.

### Создадим папку для **SSH** в корне пользователя

> Если она уже есть, пропустите этот шаг.

```bash
mkdir ~/.ssh
```

### Создаём открытый и закрытый ключи

```bash
ssh-keygen -t rsa -q -N '' -f ~/.ssh/id_rsa
```

### Воспользуемся утилитой **ssh-copy-id** для автоматической настройки

Если её нет - соболезную...

> `-p 3322` - кастомный порт. Если у вас стандартный порт, просто уберите это.

> `username` - имя пользователя, для которого и делается этот ключ.

> `127.0.0.1` - адрес хоста.

```bash
ssh-copy-id -i ~/.ssh/id_rsa.pub -p 3322 username@127.0.0.1
```

### Объясняю:

> `id_rsa.pub` - открытый ключ. Не трогаем его. Он должен лежать на сервере, пусть там и лежит.

> `id_rsa` - закрытый ключ. Копируем его себе в надёжное место. Не распространяйте его!

Для подключения к серверу по **SSH** ключу, нам нужен именно закрытый ключ.

## Подключимся через **SSH** клиент

> На примере **PuTTY**

> Некоторые клиенты могут не поддерживать никакие другие типы ключей, кроме `.ppk` - **PuTTY Private Key**

> Просто конвертируйте ваш ключ, если клиент предложит. Либо сделайте это самостоятельно.

### Сохраняем приватный ключ себе в папку

> Пусть, условно будет `C:/id_rsa` - Не делайте так! Это просто пример!

### Указываем ключ

Во вкладке: `Connection -> SSH -> Auth` есть поле **"Private key file for authentication"**

Жмём **Browse...** и идём выбираем наш `C:/id_rsa` (или просто вводим в текстовое поле)

Пробуем подключится.
